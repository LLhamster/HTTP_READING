<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <title>带聊天框的页面</title>
</head>
<body>
  <h2>带聊天功能的页面</h2>

  <div id="chat-box" style="border:1px solid #aaa; padding:10px; width:300px;">
    <div id="messages" style="height:150px; overflow:auto; border:1px solid #ddd; margin-bottom:10px;"></div>
    <input id="msg" placeholder="输入消息..." style="width:200px;">
    <button id="send">发送</button>
  </div>

  <button id="jump">跳转到新页面</button>

  <script>
    const messages = document.getElementById("messages");
    const input = document.getElementById("msg");
    const sendBtn = document.getElementById("send");
    const jumpBtn = document.getElementById("jump");

    // 发送消息（假设后端是 /chat 接口）
    sendBtn.onclick = async () => {
      const msg = input.value.trim();
      if (!msg) return;

      // 显示自己发送的消息
      messages.innerHTML += `<div>你: ${msg}</div>`;

      // 异步发送给后端
      fetch("/chat", {
        method: "POST",
        headers: { "Content-Type": "application/x-www-form-urlencoded" },
        body: "msg=" + encodeURIComponent(msg)
      })
      .then(res => res.text())
      .then(reply => {
        messages.innerHTML += `<div>服务器: ${reply}</div>`;
      })
      .catch(err => console.error(err));

      input.value = "";
    };

    // 点击跳转按钮时，发送当前消息（可选），然后跳转
    jumpBtn.onclick = () => {
      const msg = input.value.trim();
      let url = "/nextpage"; // 目标跳转页面

      // 如果你想把输入框内容传过去
      if (msg) {
        url += "?msg=" + encodeURIComponent(msg);
      }

      // 执行跳转
      window.location.href = url;
    };
  </script>
</body>
</html>